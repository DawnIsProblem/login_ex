name: Create Branch From Issue
on:
  issues:
    types: [opened]

permissions:
  contents: write

jobs:
  create-branch:
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          ref: dev # ë¸Œëœì¹˜ ìƒì„±í•  ë¶€ëª¨ ë¸Œëœì¹˜

      - name: Set up Git
        run: |
          git config user.name "${{ github.actor }}"
          git config user.email "${{ github.actor }}@users.noreply.github.com"

      - name: Extract branch name
        run: |
          echo "ì´ìŠˆ ë³¸ë¬¸:"
          echo "${{ github.event.issue.body }}"
                    branch_name=$(echo "${{ github.event.issue.body }}" \
            | perl -pe 's/\\n/\n/g' \
            | awk '/ğŸƒ ë¸Œëœì¹˜ëª…/ { while (getline line) { if (line != "") { print line; break }}}' \
            | xargs)
          echo "ì¶”ì¶œëœ ë¸Œëœì¹˜ëª…: $branch_name"
          echo "branch_name=$branch_name" >> $GITHUB_ENV

      - name: Create and push branch
        run: |
          if [ -z "${{ env.branch_name }}" ]; then
            echo "âš ï¸ ë¸Œëœì¹˜ëª…ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
            exit 0
          fi
          echo "Creating branch: ${{ env.branch_name }}"
          git checkout -b ${{ env.branch_name }}
          git push origin ${{ env.branch_name }}
